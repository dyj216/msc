\documentclass[a4paper,12pt]{article}   		% A4-es papír USLetter helyett (az a default)
\usepackage[utf8]{inputenc}           	% Latin-2-es kódolású ez a forrás
%\usepackage[T1]{fontenc}
\usepackage{t1enc}
\usepackage{lmodern}
%\usepackage{uarial}				       % betűtipus beállítás
\usepackage{indentfirst}                % az első bekezdés is behúzott legyen, ne csak a 2-tól
%\usepackage{titlepic}					% kép a címoldalra
%\usepackage{color}						% színes betűk
%\usepackage{graphicx}					% a sokumentumba képeket lehet beszúrni
\usepackage[bookmarks, colorlinks=true, linkcolor=black, citecolor=black, urlcolor=blue]{hyperref} % kilkkelhető lesz a PDF (és szépen formázott a hidelinks paranccsal) % 
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage{hyphenat}
%\def\magyarOptions{defaults=hu-min}		% A magyar tartalomjegyzékhez kell, enélkül nem jó helyre kerűl a hívatkozás. Be kell még másolni a szerkesztett doumentum könyvtárba a legújabb "magyar.ldf" fájlt. 
%\usepackage{fancyhdr} 					% élőfej formázás 
\usepackage[magyar]{babel}				% nyelvi csomagok utolsó az alapértelmezett a magyar.ldf fájlt be kell másolni a sokumentum könyvtárba
%\pagestyle{fancy}						% élőfej a lap tetején (fancy-ban az elsőlapra nem kerül)
\sloppy								% megakadályozza a jobra kilógást 8˙csúnya)

\frenchspacing                          % a mondatköz ugyanakkora nagy, mint a szóköz
\setlength{\parskip}{\smallskipamount}  % bekezdések közötti távolság beállítása %(gumi-méret: 3pt plus 1pt minus 1 pt)
\setcounter{secnumdepth}{6}				% több szintű tartalom és tartalomjegyzék
\setcounter{tocdepth}{6} 				% tartalomjegyzék mélysége

\title{Sztochasztikus folyamatok 2015-01-23 vizsga}
%\renewcommand{\thesection}{\Roman{section}}  %Római számozású szekciók 
\hyphenation{va-ló-szí-nű-ség-gel}

     
\begin{document}                        % itt kezdődik a dokumentumunk
\maketitle

Figyelem! Természetesen a kidolgozás elolvasása nem ment fel a készülés
alól. Csak azoknak tud érdemben segítséget nyújtani, akik egyébként is
készültek. A feladatok helyességére semmilyen garanciát nem vállalok!
Ha hibát találsz benne, akkor jelezd, vagy javítsd ki. A \LaTeX\ forrás
elérhető az \url{https://github.com/dyj216/msc-sze-vill} címen.

A felkészüléshez ajánlom a tanár úr honlapján megtalálható 
\texttt{\mbox{sztocha\_01.pdf}--\mbox{sztocha\_08.pdf}}-eket. Ezekre vannak hivatkozások 
ebben a kidolgozásban is. Ezek elérhetőek a 
\url{http://www.sze.hu/~harmati/sztocha2.html} címen.

\section*{1. feladat}
Szerencsejátékot játszunk, minden egyes játszmában 0,49 valószínűséggel
nyerünk 100 Ft-ot, 0,51 valószínűséggel pedig veszítünk ugyanennyit. 
Kezdetben nekünk 1000 Ft-unk van, ellenfelünknek pedig 500. A játék
addig tart, amíg valaki el nem veszíti az összes pénzét.

(a) Mi a valószínűsége annak, hogy nyerünk, illetve veszítünk? (4 pont)

(b) Ha több pénzzel kezdünk játszani, akkor nyilvánvalóan nagyobb 
valószínűséggel nyerünk. Legfeljebb mekkora lehet a nyerésünk
valószínűsége? (4 pont)
\subsection*{a)}
Egy játék nyerési valószínűsége $p$, a vesztési valószínűség $1-p=q$.

\[p = 0,49\]
\[1-p = q = 0,51\]

A tét mértéke: 100 Ft. A saját pénzünk 1000 Ft. Ebből $n_1 = 1000/100=10$ a 
játékaink száma. Az ellenfél pénze: 500 Ft. Ebből $n_2 = 500/100=5$.
$n_1 + n_2 = 15$.

A nyerés valószínűsége:
\[P(\text{nyerünk}) = \frac{1-\left(\frac{1-p}{p}\right)^{n_1}}
{1-\left(\frac{1-p}{p}\right)^{n_1+n_2}} = 
\frac{1-\left(\frac{0,51}{1,49}\right)^{10}}
{1-\left(\frac{0,51}{0,49}\right)^{15}} \approx 0,4045 \]

\[P(\text{vesztünk}) = 1 - P(\text{nyerünk}) = 1 - 0,4045 = 0,5955\]

\subsection*{b)}
1 kört inkább elvesztünk, mint megnyerünk ($p<q$), ellenfelünk pénze konstans
($n_2 = 5$), így alkalmazhatjuk a következő határérték számítást:

\[
\begin{split}
P(\text{nyerünk}) &= 
\lim_{n_1 \to \infty} \frac{1-\left(\frac{1-p}{p}\right)^{n_1}}
{1-\left(\frac{1-p}{p}\right)^{n_1+n_2}} =
\lim_{n_1 \to \infty} \frac{1-\left(\frac{1-p}{p}\right)^{n_1}}
{1-\left(\frac{1-p}{p}\right)^{n_1}\left(\frac{1-p}{p}\right)^{n_2}} =\\
&= \lim_{n_1 \to \infty} \frac{\left(\frac{1-p}{p}\right)^{n_1}}
{\left(\frac{1-p}{p}\right)^{n_1}} \cdot 
\frac{\frac{1}{\left(\frac{1-p}{p}\right)^{n_1}}-1}
{\frac{1}{\left(\frac{1-p}{p}\right)^{n_1}} -
\left(\frac{1-p}{p}\right)^{n_2}} 
= \frac{-1}{-\left(\frac{1-p}{p}\right)^{n_2}} =\\
&= \left(\frac{p}{1-p}\right)^{n_2} = 
\left(\frac{0,49}{0,51}\right)^{5} \approx 0,8187
\end{split}
\]

\pagebreak
\section*{2. feladat}
Egy Markov-lánc állapottere legyen $S=\{1,2,3,4,5\}$, átmenetvalószínűségi
mátrixa pedig:
\[
P = 
\begin{bmatrix}
1/2	&	1/2	&	0	&	0	&	0	\\
0	&	1/2	&	1/2	&	0	&	0	\\
0	&	0	&	1/2	&	1/2	&	0	\\
0	&	0	&	0	&	1/2	&	1/2	\\
1	&	0	&	0	&	0	&	0
\end{bmatrix}
\]

(a) Irreducibilis-e a Markov-lánc? (3 pont)

(b) Határozzuk meg az invariáns eloszlást! (5 pont)

(c) Tegyük fel, hogy az 1-esből indulunk. Átlagosan hány lépéssel érünk
vissza? (3 pont)

(d) Tegyük fel, hogy a 2-esből indulunk. Átlagosan hány lépéssel érünk
az 5-ösbe? (5 pont)

\subsection*{a)}
Szerintem sokat segít, ha felrajzoljuk a mátrix állapotokat is a mátrix
széleire.

\[
\mathbf{P} = 
\bordermatrix{
~	&	1	&	2	&	3	&	4	&	5	\cr
1	&	1/2	&	1/2	&	0	&	0	&	0	\cr
2	&	0	&	1/2	&	1/2	&	0	&	0	\cr
3	&	0	&	0	&	1/2	&	1/2	&	0	\cr
4	&	0	&	0	&	0	&	1/2	&	1/2	\cr
5	&	1	&	0	&	0	&	0	&	0}
\]

Az irreducibilis azt jelenti hogy nem felbontható, tehát mindegyik 
állapot kapcsolódó. Megint másképpen megfogalmazva: bármely 
állapotból kiindulva elérhető bármely másik állapot. Ezt nagyon jól
lehet látni, amennyiben felrajzoljuk az állapotátmeneti gráfot.
Azon egyértelműen látható, hogy egy rekurrens osztály van:
$\{1, 2, 3, 4, 5\}$.

\subsection*{b)}
Itt a mátrix oszlopait tekintve lehet felírni az alábbi egyenleteket:

\begin{align*}
\pi_1 &= 0,5 \pi_1 + \pi_5 \\
\pi_2 &= 0,5 \pi_1 + 0,5 \pi_2 \\
\pi_3 &= 0,5 \pi_2 + 0,5 \pi_3 \\
\pi_4 &= 0,5 \pi_3 + 0,5 \pi_4 \\
\pi_5 &= 0,5 \pi_4 \\
\text{Ezt meg } &\text{tudjuk a tanulmányainkból:} \\
\sum_{i} \pi_i &= 1 = \pi_1 + \pi_2 + \pi_3 + \pi_4 + \pi_5
\end{align*}

Ezt az egyenletrendszert végig kell oldani, és akkor megkapjuk a
megoldást erre kérdésre:

\[
\pi_1 = \frac{2}{9},
\pi_2 = \frac{2}{9},
\pi_3 = \frac{2}{9},
\pi_4 = \frac{2}{9},
\pi_5 = \frac{1}{9},
\]

\subsection*{c)}
Ez nagyon egyszerű, ha már meghatároztuk az invariáns eloszlást:

\[
E(T_{1\to1}) = \frac{1}{\pi_1} = \frac{9}{2} = 4,5
\]

\subsection*{d)}
A feltételt úgy valósíthatjuk meg, hogy létrehozunk egy új $h$
állapotot, amely a kiindulási állapot lesz és ahonnan a kettes
állapotba fogunk átlépni. Az ötös állapotból pedig a $h$ állapotba 
lépünk. Az új $\mathbf{P}$ mátrix:

\[
\mathbf{P} = 
\bordermatrix{
~	&	1	&	2	&	3	&	4	&	5	&    h    \cr
1	&	1/2	&	1/2	&	0	&	0	&	0	&    0    \cr
2	&	0	&	1/2	&	1/2	&	0	&	0	&    0    \cr
3	&	0	&	0	&	1/2	&	1/2	&	0	&    0    \cr
4	&	0	&	0	&	0	&	1/2	&	1/2	&    0    \cr
5	&	0	&	0	&	0	&	0	&	0   &    1    \cr
h	&	0	&	1	&	0	&	0	&	0   &    0}
\]

Viszont ez a mátrix már nem irreducibilis, hiszen nem csak rekurrens
osztályokból áll, hanem tranziens állapot (tranziens állapot = ha 
elhagytuk az állapotot, akkor már nem térünk bele vissza) is található 
benne. Ez szintén jól látható az állapotátmeneti gráfon.

Tehát az ${1}$ tranziens osztályt eltávolítva a $\mathbf{P}$ mátrixból
megkapjuk az egyetlen ${2, 3, 4, 5, h}$ rekurrens osztályból álló
$\mathbf{P'}$ mátrixot.

\[
\mathbf{P'} = 
\bordermatrix{
~	&	2	&	3	&	4	&	5	&    h    \cr
2	&	1/2	&	1/2	&	0	&	0	&    0    \cr
3	&	0	&	1/2	&	1/2	&	0	&    0    \cr
4	&	0	&	0	&	1/2	&	1/2	&    0    \cr
5	&	0	&	0	&	0	&	0   &    1    \cr
h	&	1	&	0	&	0	&	0   &    0}
\]

Ennek is fel kell írni és ki kell számolni az invariáns eloszlását:

\begin{align*}
\pi_2 &= 0,5 \pi_1 + \pi_h \\
\pi_3 &= 0,5 \pi_2 + 0,5 \pi_3 \\
\pi_4 &= 0,5 \pi_3 + 0,5 \pi_4 \\
\pi_5 &= 0,5 \pi_4 \\
\pi_h &= \pi_5 \\
1 &= \pi_2 + \pi_3 + \pi_4 + \pi_5 + \pi_h
\end{align*}

Ezekből kiszámolva:

\[
\pi_h = \frac{1}{8}
\]

A többi nem érdekes, hiszen ebből kiszámolható a $2$-ből $5$-be
jutás várható értéke. Azért kell levonni $2$-t, mert jelenleg a
$h$-ból $h$-ba megyünk, és nem az a kérdés.

\[
E(T_{2 \to 5}) = E(T_{h \to h}) - 2 = \frac{1}{\pi_h} - 2 =
8-2 = 6
\]

\pagebreak
\section*{3. feladat}
Két urnában ($A$ és $B$) összesen két golyó van. Egy szabályos 
dobókockával dobunk. Ha a dobott szám hatos vagy egyes, akkor egy
golyót átrakunk $A$-ból $B$-be, a többi esetben egy golyót teszünk
át $B$-ből $A$-ba. Ha üres urnából kellene golyót áttenni a másikba,
akkor nem csinálunk semmit, de azt is egy lépésnek tekintjük.
Tekintsük állapotnak a golyók számát az $A$ urnában!

(a) Adjuk meg az átmeneti valószínűségi mátrixot! (5 pont)

(b) Adjuk meg az invariáns eloszlást! (5 pont)

\pagebreak
\section*{4. feladat}
Egy üzletbe Poisson-folyamat szerint érkeznek a vevők, óránként 
átlagosan 10.

(a) Mi a valószínűsége annak, hogy 5 perc alatt jön vevő? (3 pont)

(b) Feltéve, hogy 10 percig nem jött senki, mi a valószínűsége, hogy a
következő 20 percben legalább ketten jönnek? (3 pont)

(c) Feltéve, hogy az első félórában 4 vevő jött, mi a valószínűsége, 
hogy összesen 10 vevő jön az első órában? (4 pont)

\subsection*{a)}
Szerintem az alapötleted jó, tehát a keresett valószínűség:
\[P(\text{keresett}) = 1 - P(X = 0)\]
de, a paraméter az megváltozik: $10 \cdot 5/60 = 5/6$ lesz (10 volt kezdetben, 
és az 1 órára adott ennyit, most 5 percre kell, így jön ki a
\texttt{sztocha6.pdf} példája alapján, amit a honlapról 
\url{http://www.sze.hu/~harmati/sztocha2.html} le lehet tölteni). 
Így a képlet:
\[P(X) = 1 - P(X_\frac{5}{60} = 0) = 1 - \frac{\frac{5}{6}^0}{0!}
e^{-\frac{5}{6}} \approx 0,5654\]

\subsection*{b)}
Hasonlóan itt is a paraméter megválasztása szerintem helytelen. A helyes 
paraméter szerintem: $10 \cdot 20/60 = 10/3$.
\[P(X_{1/3} \geq 2) = P(X_{1/2}-X_{1/6} \mid X_{1/6}=0)\]
Valóban diszjunktak az időtartamok, tehát a feltétel lényegtelen.
\[
P(X_{20/60} \geq 2) = 1 - \left( P(X_{20/60} = 0)+P(X_{20/60} = 1)\right)
\]
\[
P(X_{20/60} \geq 2) = 1 - \frac{\left(\frac{10}{3}\right)^0}{0!}e^
{-\frac{10}{3}} - \frac{\left(\frac{10}{3}\right)^1}{1!}e^{-\frac{10}{3}} 
\approx 0,8454
\]

\subsection*{c)}
Itt ugye az a nehézség, hogy nem diszjunktak az időpillanatok így nem
hagyhatóak el a feltételek.
\begin{equation*}
\begin{split}
P(X_{60/60} = 10 \mid X_{30/60} = 4) &= \frac{P(X_1 = 10 \cap X_{1/2} = 4)}
{P(X_{1/2} = 4)} \\
&= \frac{P(X_1-X_{1/2} = 6 \cap X_{1/2} = 4)}{P(X_{1/2} = 4)}
\end{split}
\end{equation*}
A paraméter alakulása fél órára: $10 \cdot 30/60 = 5$
\[
\frac{P(X_{1/2} = 6 \cap X_{1/2} = 4)}{P(X_{1/2} = 4)} = \frac{\frac{5^6}{6!}
e^{-5} \cdot \frac{5^4}{4!} e^{-5}}{\frac{5^4}{4!} e^{-5}}
\]
Egyszerűsítve:
\[
\frac{P(X_{1/2} = 6 \cap X_{1/2} = 4)}{P(X_{1/2} = 4)} = 
\frac{5^4}{4!} e^{-5} \approx 0,1462
\]

\pagebreak
\section*{5. feladat}
Egy üzletben egyetlen eladó dolgozik, aki exponenciális eloszlású idő 
alatt szolgál ki egy vevőt (az átlagos kiszolgálási idő 5 perc). A vevők
érkezése között eltelt idő  szintén exponenciális eloszlású, továbbá 
tudjuk azt is, hogy egy óra alatt átlagosan 8 vevő érkezik. Az üzlet 
befogadóképessége végtelen.

(a) Mi a valószínűsége, hogy van vevő a boltban? (4 pont)

(b) Mi a valószínűsége annak, hogy pontosan annyi vevő van a boltban, 
amennyi a boltban tartózkodó vevők számának várható értéke? (4 pont)

(c) Átlagosan mennyi időt tölt el egy vevő a boltban? (4 pont)

(d) Átlagosan hányan várják azt, hogy végre sorra kerüljenek? (4 pont)

\end{document}                          % vége a dokumentumnak és a fájlnak